<div class="content" style="direction:rtl">
    <AddPackage v-if="state==1"></AddPackage>
    <div class="row" v-if="state==0">
        <div class="col-md-12">
            <div class="card">
                <div class="card-header">
                    <h4 class="card-title"><i class="nc-icon nc-bank" style="color:#ef8157 ;margin-left: 5px;" ></i> إدارة الإشتراكات</h4>
                </div>
                <div class="card-body">
                    <div class="toolbar">

                        <!--        Here you can write extra buttons/actions for the toolbar              -->

                        <div class="row">
                            <div class="col-md-3">

                                <el-select style="width: 100%;" filterable placeholder="البحت" v-model="SearchTypeSelected" @change="getPackeges(1,0,0)">

                                    <el-option v-for="item in SearchType"
                                               :key="item.id"
                                               :label="item.name"
                                               :value="item.id">
                                    </el-option>

                                </el-select>
                            </div>

                            <div class="col-md-3" v-if="SearchTypeSelected==1">

                                <el-select style="width: 100%;" filterable placeholder="إسم العميل" v-model="CoustmorSelected" @change="getPackeges(1,1,CoustmorSelected)">

                                    <el-option v-for="item in custmors"
                                               :key="item.customerId"
                                               :label="item.fullName"
                                               :value="item.customerId">
                                    </el-option>

                                </el-select>
                            </div>

                            <div class="col-md-3" v-if="SearchTypeSelected==2">

                                <el-select style="width: 100%;" filterable placeholder="رقم الخدمة" v-model="CodeSelectd" @change="getPackeges(1,2,CodeSelectd)">

                                    <el-option v-for="item in codes"
                                               :key="item.id"
                                               :label="item.code"
                                               :value="item.id">
                                    </el-option>

                                </el-select>
                            </div>

                            <div class="col-md-3" v-if="SearchTypeSelected==3">

                                <el-select style="width: 100%;" filterable placeholder="الحالة" v-model="pakegeStatusSelected" @change="getPackeges(1,3,pakegeStatusSelected)">

                                    <el-option v-for="item in pakegeStatus"
                                               :key="item.id"
                                               :label="item.name"
                                               :value="item.id">
                                    </el-option>

                                </el-select>
                            </div>



                        </div>
                        <div class="disabled-sorting text-right" style="margin-top:-49px">
                            <el-button class="btn btn-primary" type="primary" @click="addPackege">الإشتراك في باقة جديدية</el-button>
                        </div>



                    </div>
                    <!--Stop SMS Service-->
                    <el-dialog :visible.sync="StopSMSServiceDialog" :modalAppendToBody="false" @visible-change="onVisible">

                        <div>
                            <div class="modal-header">
                                <h5 class="modal-title">أنت علي وشك القيام بإيقاف الخدمة الرجاء تعبئة البيانات  التالية</h5>
                            </div>
                            <div class="modal-body">
                                <div class="instruction">
                                    <div class="row">
                                        <div class="col-md-12">
                                            <h5> سبب الإيقاف</h5>
                                            <el-input type="textarea"
                                                      :rows="4"
                                                      placeholder=" الرجاء إدخال سبب الإيقاف"
                                                      v-model="stopResone">
                                            </el-input>
                                        </div>
                                    </div>
                                </div>
                                <br />
                                <br />
                                <div class="instruction">
                                    <div class="row">
                                        <div class="col-md-12">
                                            <h5>هل تريد إرسال رسالة للعميل توضح سبب إيقاف الخدمة</h5>

                                            <el-input type="textarea"
                                                      :rows="4"
                                                      v-model="SMSstopResone">
                                            </el-input>
                                        </div>
                                    </div>
                                </div>
                                <p>في حال لم تقم بتعديل نص الرسالة سيتم إرسال الرسالة للتوضيح</p>
                            </div>
                            <div class="modal-footer justify-content-center">
                                <el-button class="btn btn-danger" @click="canselStoped()">
                                    إلغاء العملية
                                </el-button>
                                <el-button class="btn btn-twitter" @click="stopServeice">
                                    إيقاف الخدمة
                                </el-button>


                            </div>
                        </div>
                    </el-dialog>

                    <!--SMS Service Info-->
                    <el-dialog :visible.sync="SMSServiceInfoDialog" :modalAppendToBody="false" @visible-change="onVisible">

                        <div>
                            <div class="modal-header">
                                <h5 class="modal-title">عرض البيانات الخاصة بي الباقة </h5>
                            </div>
                            <div class="modal-body">
                                <div class="card ">
                                    <div class="card-header " style="margin-right:5%">
                                        <h5 class="card-title">
                                            {{selectedPackege.code}}


                                        </h5>


                                        <p class="card-category">{{selectedPackege.service}}</p>
                                        <hr />
                                    </div>
                                    <div class="card-body ">
                                        <div class="row">
                                            <div class="col-md-4">

                                                <el-progress type="circle" :percentage="selectedPackege.usagePercentage"></el-progress>
                                            </div>
                                            <div class="col-md-8">

                                                <div class="row"
                                                     style="font-family:'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;color:lightslategrey">
                                                    <div class="col-md-7">
                                                        <div>
                                                            <h6>
                                                                قيمة الإشتراك
                                                            </h6>
                                                            <h6 style="margin-top:15px">
                                                                القيمة المدفوعة
                                                            </h6>
                                                            <h6 style="margin-top:15px">
                                                                إجمـــالــي عــدد الرســائــل
                                                            </h6>
                                                            <h6 style="margin-top:15px">
                                                                الرسائل المستخدمة
                                                            </h6>
                                                            <h6 style="margin-top:15px">
                                                                الرسائل المتبقية
                                                            </h6>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <div>
                                                            <h6>
                                                                {{selectedPackege.amount}} دينار
                                                            </h6>
                                                            <h6 style="margin-top:15px">
                                                                {{selectedPackege.amount}} دينار
                                                            </h6>
                                                            <h6 style="margin-top:15px">
                                                                {{selectedPackege.smsCount}} رسالــة
                                                            </h6>
                                                            <h6 style="margin-top:15px">
                                                                {{selectedPackege.usageSMS}} رسالــة
                                                            </h6>

                                                            <h6 style="margin-top:15px">
                                                                {{selectedPackege.remindSMS}} رسالــة
                                                            </h6>

                                                        </div>
                                                    </div>

                                                </div>

                                            </div>

                                        </div>
                                    </div>
                                    <div class="card-footer ">
                                        <div class="legend">
                                            <i class="fa fa-circle text-info"></i> Active
                                        </div>
                                        <hr>
                                        <div class="row" style="padding-right:20px">
                                            <div class="stats">
                                                تاريخ الإشتراك
                                                <br />
                                                <i class="fa fa-calendar"></i> {{selectedPackege.from | moment}}
                                                <br />
                                            </div>
                                            <div class="stats" style="/* FONT-WEIGHT: 500; */float: left;display: block;left: 20px;position: absolute;">
                                                صلاحية الباقة
                                                <br> <i class="fa fa-calendar"></i> {{selectedPackege.to | moment}}
                                                <br>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>
                    </el-dialog>

                    <!--Reload SMS Service -->
                    <el-dialog :visible.sync="ReloadServiceDialog" :modalAppendToBody="false" @visible-change="onVisible">
                        <div class="modal-header">

                            <h5 class="modal-title" id="myModalLabel">إعادة الإشتراك بالباقة</h5>
                        </div>
                        <br />
                        <br />
                        <el-form :model="ReloadserviceInfo" ref="ReloadserviceInfo">
                            <div class="tab-pane active show" id="address">
                                <div class="row justify-content-center">

                                    <div class="col-sm-7">
                                        <div class="form-group">
                                            <label>عدد الرسائل</label>
                                            <el-form-item prop="countMassage"
                                                          label-width="0px"
                                                          :rules="[{required: true, message: 'الرجاء إدخال عدد الرسائل'}
                                                                  ,{ type: 'number', message: 'يجب أن يكون الحقل أرقام فقط'}]">
                                                <el-input type="countMassage"
                                                          placeholder="عدد الرسائل"
                                                          v-model.number="ReloadserviceInfo.countMassage"
                                                          autocomplete="off" />
                                            </el-form-item>
                                        </div>
                                    </div>
                                    <div class="col-sm-3">
                                        <div class="form-group">
                                            <label>القيمة</label>
                                            <el-form-item prop="amount"
                                                          label-width="0px"
                                                          :rules="[{required: true, message: 'الرجاء إدخال القيمة'}
                                                                  ,{ type: 'number', message: 'يجب أن يكون الحقل أرقام فقط'}]">
                                                <el-input type="amount"
                                                          placeholder="القيمة"
                                                          v-model.number="ReloadserviceInfo.amount"
                                                          autocomplete="off" />
                                            </el-form-item>
                                        </div>
                                    </div>
                                    <div class="col-sm-5">
                                        <div class="form-group">
                                            <label>تاريخ إنتهاء الصلاحية</label>
                                            <el-form-item prop="to"
                                                          label-width="0px"
                                                          :rules="[{ required: true, message: 'الرجاء إدخال تاريخ  '} ]">

                                                <el-date-picker style="width:100%"
                                                                v-model="ReloadserviceInfo.to"
                                                                type="date"
                                                                placeholder="من">
                                                </el-date-picker>

                                            </el-form-item>
                                        </div>
                                    </div>
                                    <div class="col-sm-5">
                                        <div class="form-group select-wizard" style="float:left ;">
                                            <el-button class="btn btn-twitter" @click="submitForm('ReloadserviceInfo')">
                                                تجديد الباقة
                                            </el-button>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </el-form>
                    </el-dialog>
                    <br />
                    <br />
                    <table id="datatable" class="table table-striped table-bordered" cellspacing="0" width="100%">
                        <thead>
                            <tr class="text-primary">
                                <th>#</th>
                                <th>إسم العميل</th>
                                <th>رقم الخدمة </th>
                                <th> الخدمة </th>
                                <th>القيمة المدفوعة </th>
                                <th>عدد الرسائل  </th>
                                <th>الرسائل المستخدمة </th>
                                <th>تاريخ الصلاحية</th>
                                <th>الحالة</th>
                                <th class="disabled-sorting text-right">الإعدادات</th>
                            </tr>
                        </thead>
                        <tbody style="text-align:right">
                            <tr v-for="packege,index in packeges" style="font-size:11.3pt;">
                                <td>{{index+1 }} </td>
                                <td>{{packege.fullName }} </td>
                                <td>{{packege.code}}</td>
                                <td>{{packege.service}}</td>
                                <td>{{packege.amount}}</td>
                                <td>{{packege.smsCount}}</td>
                                <td>{{packege.usageSMS}}</td>
                                <td>{{packege.to | moment}}</td>
                                <!--<td>{{packege.status}}</td>-->
                                <td v-if="packege.state==1">
                                    Active
                                </td>
                                <td v-if="packege.state==2">
                                    Not Active
                                </td>
                                <td v-if="packege.state==3">
                                    Stopped
                                </td>


                                <td class="text-right">

                                    <a title="تجديد الباقة" v-if="packege.state!=3" href="#" class="btn btn-warning btn-link btn-icon btn-sm edit " @click.prevent="showReloadSMS(packege)">
                                        <i class="nc-icon nc-refresh-69" style="font-size:13px"></i>
                                    </a>

                                    <a title="متابعة الباقة" href="#" class="btn btn-info btn-link btn-icon btn-sm like" @click.prevent="showSmsInfo(packege)">
                                        <i class="fa fa-line-chart" style="font-size:13px"></i>
                                    </a>
                                    <a href="#" title="إيقاف الخدمة" class="btn btn-danger btn-link btn-icon btn-sm remove" @click.prevent="showStopSMSDialog(packege)"
                                       v-if="packege.state!=3">
                                        <i class="fa fa-pause" style="font-size:13px"></i>
                                    </a>
                                    <a href="#" title="إلغاء الإيقاف" class="btn btn-success btn-link btn-icon btn-sm like" @click.prevent="backService(packege)"
                                       v-if="packege.state==3">
                                        <i class="fa fa-play" style="font-size:13px"></i>
                                    </a>
                                </td>

                            </tr>
                        </tbody>
                    </table>
                    <div class="row" dir="ltr">
                        <div class="col-sm-12 col-md-5">
                            <div class="disabled-sorting text-right" id="datatable_info" role="status" aria-live="polite">Showing {{pageNo}} to {{pageSize}} of {{pages}} entries</div>
                        </div>

                        <div style="text-align: center; ">

                            <el-pagination background
                                           layout="prev, pager, next"
                                           :current-page="pageNo"
                                           :page-size="pageSize"
                                           :total="pages"
                                           @current-change="getPackeges($event)">
                            </el-pagination>

                        </div>

                    </div>
                </div>
                <!-- end content-->
            </div>
            <!--  end card  -->
        </div>
        <!-- end col-md-12 -->
    </div>
    <!-- end row -->
</div>

       